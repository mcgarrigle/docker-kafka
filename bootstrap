#!/bin/bash

CONFIG='/opt/kafka/config/server.properties'

for var in "${!KAFKA_@}"; do
   PROPERTY=$(echo ${var,,} | tr '_' '.')
   PROPERTY="${PROPERTY:6}"
   sed -i "s/^$PROPERTY.*\$//" $CONFIG
   echo "$PROPERTY=${!var}" >> $CONFIG
done

for rc in /etc/rc3.d/S*; do
  (bash $rc start)&
done

echo '// waiting forever'
sleep infinity
